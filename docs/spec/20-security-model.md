# 20 安全模型（Security Model）

jiayi-fsp 面向可信局域网，安全边界与威胁模型基于该假设。强认证与加密可按部署需求选择性启用。

## 20.1 安全假设

- 局域网内设备可信
- Broker 与 Server 受控
- 不提供公网穿透

## 20.2 控制面安全

- MQTT 可启用 TLS（建议）
- 使用用户名/密码或客户端证书
- ACL 强制隔离 client_id 的发布/订阅范围

## 20.3 数据面安全

- UDP 包级完整性使用 CRC32（非安全性）
- 文件级完整性使用内容 hash（安全校验）
- 可选数据加密由实现层提供（非协议强制）

## 20.4 状态与权限

- 所有 UDP 会话必须绑定 MQTT Session
- Server 不主动向未知端口发送 UDP
- TCP 降级需再次校验权限

## 20.5 审计

- 记录跨 client_id 的访问尝试
- 记录 session_abort 原因与上下文
